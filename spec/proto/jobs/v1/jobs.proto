syntax = "proto3";

package jobs.v1;

option go_package = "github.com/makeopensource/leviathan/generated/jobs/v1";

import "types/v1/types.proto";

service JobService {
  rpc NewJob(NewJobRequest) returns (NewJobResponse) {}
  rpc StreamJobLogs(JobLogRequest) returns (stream JobLogsResponse) {}
  rpc CancelJob(CancelJobRequest) returns (CancelJobResponse) {}
}

message NewJobRequest {
  types.v1.FileUpload makeFile = 1;
  types.v1.FileUpload graderFile = 2;
  types.v1.FileUpload studentSubmission = 3;
  types.v1.FileUpload dockerFile = 4;
  string imageName = 5;
  uint64 jobTimeoutInSeconds = 6;
}

message NewJobResponse {
  string jobId = 1;
}

message JobLogRequest {
  string jobId = 1;
}

message JobLogsResponse {
  string logs = 1;
}

message CancelJobRequest {
  string jobId = 1;
}

message CancelJobResponse {}
